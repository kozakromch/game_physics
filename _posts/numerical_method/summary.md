
## Применение в физических движках

<div>
Почти все перечисленные методы используются или использовались в физических движках.
Явный метод используется на самых ранних этапах разработки движка. Вот например в годоте обсуждение об отказе. 
Поскольку в при симуляции нужно решать не только систему дифференциальных уравнений, но и учитывать различные ограничения ( столкновения и прочие связи) то на самом деле решается не ODE а DAE. Поэтому обычно выбирается простой и устойчивый метод решения и уже модифицируется.

Например неявный метод частично используется в XPBD, но он настолько изменен, что даже создатели метода не сразу поняли, что они его используют)


Стоит сказать, что в физических движках всегда идет трейд офф между разными необходимостями. 
Например, если у нас есть много объектов, то нам важно чтобы метод был быстрый. 
Если у нас много связей, то нам важно чтобы метод был устойчивым. 

### Путаница с полуявным

Сейчас стандартный метод решения это полуявный метод Эйлера. Точнее его так называют, но на самом деле используют упрощенную версию

Вот так выглядит полуявный метод Эйлера
\begin{equation}
    \begin{split}
        &\dot{v}_{k+1} = \dot{v}_k + f(x_k, v_{k+1})\Delta t.
        &x_{k+1} = x_k + \dot{v}_k\Delta t,\\
    \end{split}
\end{equation}

Редкий разработчик захочет решать неявное уравнения для скорости, на это просто забивают и решают такое:
\begin{equation}
    \begin{split}
        &v_{k+1} = v_k + f(x_k, v_k)\Delta t.
        &x_{k+1} = x_k + v_{k+1}\Delta t,\\
    \end{split}
\end{equation}

Хотя иногда  это приводит к возрастанию энергии и некоторые по-честному решают неявное уравнение (ссылка на дьябло)

А другие просто забивают на требование считать скорость на следующем шаге и используют уже известную. Такой метод в геймдеве все так же называют полуявным Эйлером.

Главное, не сделать полностью явный метод
Вот так выглядит явный метод
\begin{equation}
    \begin{split}
        &\v_{k+1} = v_k + f(x_k, v_k)\Delta t.
        &x_{k+1} = x_k + v_k\Delta t,\\
    \end{split}
\end{equation}

А вот для полуявного Эйлера
\begin{equation}
    \begin{split}
        &\dot{x}_{k+1} = \dot{x}_k + f(x_k)\Delta t.
        &x_{k+1} = x_k + \dot{x}_{k+1}\Delta t,\\
    \end{split}
\end{equation}
Разница в том, что скорость на следующем шаге считается по новому положению.
Это позволяет взять часть свойств полуявного метода в системах с которыми явный метод несправляется. Например в колебательных системах.

Для такой системы наш новый метод является симплектичным.

За это свойство полуявного метода его и любят.Те мы можем очень просто симулировать колебательные истории, что для игр часто очень нужно. 

Если же у нас появляется какой-то демпинг, то метод уже и не будет симплектичным, но оно и не нужно. Энергия все равно будет убывать. Причем чем ближе демпинг к нулю, тем меньше она будет убывать. Т е метод все равно будет работать лучше чем явный метод Эйлера.
А для более сложных систем придумывают свои ad-hoc приближения. 
</div>

### Почему не другие

<div>

Стандартный Верле где отказались от вывода скорости в явном виде используется для симуляции частиц и тканей, но не для симуляции твердых тел. Не имея скорости проблематично сделать достоверную коллизию для твердого тела. Для частицы это просто такое провернуть очень просто. 

Я не видел чтобы в популярных движках использовался Velocity Verlet. По своей сути он такой же как и symplectic Euler, но еще точнее.
Одна из причин по которой он не такой популярный -- равноускоренное движение в течении дельты. Для симуляции вращений твердых тел нужно решать дифур, который выглядит просто если движение без ускорений и гораздо сложнее если движение равноускоренное. Если оно еще более сложное, то уравнения становятся слишком сложными. А Symplectic Euler достаточно стабильный и позволяет считать движение равномерным в течении дельты.

</div>

[]: # (end)
