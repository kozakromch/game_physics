<!DOCTYPE HTML>
<html lang="en" >
    <head><meta charset="UTF-8">
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"><title>Численные методы · Physics in Games</title><meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="description" content="Physics in Games is a collection of articles about physics in video games. The articles are written in a simple and understandable language, so that even a person who is not familiar with physics can understand them.
"><meta name="generator" content="Jekyll (using style of GitBook 3.2.3)"><meta name="author" content="Roman Kozak"><link rel="stylesheet" href="/physics-in-games/assets/bootstrap-5.3.3-dist/css/bootstrap.css">
<link rel="stylesheet" href="/physics-in-games/assets/gitbook/style.css">
<link rel="stylesheet" href="/physics-in-games/assets/gitbook/gitbook-plugin-back-to-top-button/plugin.css">
<link rel="stylesheet" href="/physics-in-games/assets/gitbook/gitbook-plugin-expandable-chapters-small2/expandable-chapters-small.css">
<link rel="stylesheet" href="/physics-in-games/assets/gitbook/gitbook-plugin-fontsettings/website.css">
<link rel="stylesheet" href="/physics-in-games/assets/gitbook/gitbook-plugin-search-pro/search.css">
<link rel="stylesheet" href="/physics-in-games/assets/gitbook/gitbook-plugin-splitter/splitter.css">

<link rel="stylesheet" href="/physics-in-games/assets/gitbook/rouge/colorful.css">

<link rel="stylesheet" href="/physics-in-games/assets/gitbook/custom.css">
<link rel="stylesheet" href="/physics-in-games/assets/gitbook/custom-local.css">

<meta name="HandheldFriendly" content="true"/>
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="/physics-in-games/assets/gitbook/images/apple-touch-icon-precomposed-152.png">
<link rel="shortcut icon" href="/physics-in-games//assets/gitbook/images/favicon.ico" type="image/x-icon">
            <link rel="prev" href="/physics-in-games/" />
        

        
    </head>
    <body>
        <div class="book"><div class="book-summary">
    <script type="text/javascript">
        // Fixes the page links scroll problem on both desktop and mobile browsers
        function pageScrollToTop(element) {
            // both mobile and non-mobile
            $('div.body-inner').animate({scrollTop: 0});
            $(element).parent().find('li>ul>li').removeClass('active');
            return true;  // propagate
        }
        // Fixes the anchor links scroll problem on mobile browsers
        function mobilePageScrollToAnchor(element) {
            $(element).closest('li.chapter').find('ul>li').removeClass('active');
            $(element).parent().addClass('active');
            if ($(document).width() <= 1240) {
                $('div.body-inner').animate({scrollTop: $($(element).attr('href')).get(0).offsetTop});
            }
            return true;
        }
    </script>

    <nav role="navigation">
        <div id="book-search-input" role="search">
            <input type="text" placeholder="Type to search" />
        </div>
        <div id="book-search-input-link" role="search">
            <a href="/physics-in-games/assets/search.html">Click to Search</a>
        </div>
        <ul class="summary">
            
            <li class="chapter" data-level="1.1" data-path="/physics-in-games">
            
                <a href="/physics-in-games/" onclick="pageScrollToTop(this)">
                    Physics in Games
                </a>
            </li>

            <li class="divider"></li>

            
                <!-- <p>pages</p> -->
                
                    

                    
                        
                        <li class="chapter" data-level="1.1" data-path="/physics-in-games/pages/design/draft/">
                        
                            <a href="/physics-in-games/pages/design/draft/" onclick="pageScrollToTop(this)">
                                Design Draft
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/physics-in-games/pages/about/">
                        
                            <a href="/physics-in-games/pages/about/" onclick="pageScrollToTop(this)">
                                About
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/physics-in-games/pages/contact/">
                        
                            <a href="/physics-in-games/pages/contact/" onclick="pageScrollToTop(this)">
                                Contact
                            </a>
                            
                                
                            
                        </li>
                    

                    
                        <li class="divider"></li>
                    
                
            
                <!-- <p>posts</p> -->
                
                    

                    
                        
                        <li class="chapter active" data-level="1.2" data-path="/physics-in-games/jekyll/2024-03-28-numerical_method.html">
                        
                            <a href="/physics-in-games/jekyll/2024-03-28-numerical_method.html" onclick="pageScrollToTop(this)">
                                Численные методы
                            </a>
                            
                                
                                    <ul><li><a href="#модельная-задача" onclick="mobilePageScrollToAnchor(this)" >Модельная задача</a></li><li><a href="#прямой-метод-эйлера" onclick="mobilePageScrollToAnchor(this)" >Прямой метод Эйлера</a></li><li><a href="#обратный-метод-эйлера" onclick="mobilePageScrollToAnchor(this)" >Обратный метод Эйлера</a></li><li><a href="#метод-рунге-кутты-второго-порядка" onclick="mobilePageScrollToAnchor(this)" >Метод Рунге-Кутты второго порядка</a></li><li><a href="#метод-эйлера-кромера" onclick="mobilePageScrollToAnchor(this)" >Метод Эйлера-Кромера</a></li></ul>

                                
                            
                        </li>
                    

                    
                        <li class="divider"></li>
                    
                
            
        </ul>
    </nav>
</div>
<div class="book-body">
                <div class="book-header" role="navigation">
                    <!-- Title -->
                    <h1>
                        <i class="fa fa-circle-o-notch fa-spin"></i>
                        
                            <a href="." >Численные методы</a>
                        
                    </h1>
                </div>

                <div class="body-inner"><div class="page-wrapper" tabindex="-1" role="main">
    

    <div class="page-inner">
        <div id="book-search-results">
            <div class="search-noresults">
                <section class="normal markdown-section">
                    
                        <h1 id="/jekyll/numerical_method">Численные методы</h1>
                    

                    <script src="/physics-in-games/assets/scripts/p5.min.js"></script>

<script src="/physics-in-games/assets/scripts/math.js"></script>

<script src="/physics-in-games/assets/scripts/numerical_method/forward_euler.js"></script>

<div>
В прошлой лекции мы попытались решить уравнения движения аналитически. Поскольку некоторые уравнения были не разрешимы, то мы их линеаризовывали. Однако многие эффекты терялись поскольку были нелинейными. 
Поскольку аналитически решить все уравнения невозможно, то мы перейдем к численным методам.

Посмотрим на уравнение в общем виде
\begin{equation}
    \dot{x} = f(x)
\end{equation}
и мы пытались получить из него решение вида
\begin{equation}
    x = F(t) + C
\end{equation}
подставив в которое начальные коодинаты мы могли найти положение в любой момент времени.
Теперь же мы будем искать траекторию, т.е. из начальной координаты $x_0$ численно находим положение в следующий момент времени $x_1$, из него аналогично $x_2$ и т.д. Где раньше мы находили все фазовые траектории, теперь мы будем находить только одну, и ту приближенно.

</div>

<h3 id="модельная-задача">Модельная задача</h3>

<div>

Для того чтобы анализировать методы численного решения уравнений движения, рассмотрим простую модельную задачу. Пусть у нас есть пружинка с коэффициентом жесткости $k$, массой $m$ и начальным смещением $x_0$, а так же вязким трением с коэффициентом $d$.
К уже обсужденным закону Гука ($F(x) = -k \cdot x$) и второму закону Ньютона ($\Sigma \vec{F} = m \cdot \vec{a}$) добавится закон вязкого трения:
\begin{equation}
    \vec{F} = -c \cdot \vec{V}
\end{equation}
\input{pics/Scheme.tex}
Введем новые обозначения:
\begin{equation}
    \begin{split}
        d = \frac{c}{2 \sqrt{km}},\\
        \omega_0 = \sqrt{\frac{k}{m}}
    \end{split}
\end{equation}
Подставляя всё это во второй закон Ньютона, получим
\begin{equation}
    \ddot{x} + 2d\omega_0\dot{x} + \omega_0^2 x = 0
\end{equation}
Как и ранее, запишем вектор

\begin{equation}
    z =
     \begin{bmatrix}     1 &amp; x &amp; x^2 \\     1 &amp; y &amp; y^2 \\     1 &amp; z &amp; z^2 \\     \end{bmatrix} 
\end{equation}
Тогда уравнение перепишем в виде
\begin{equation}
    \dot{z} =
    \begin{bmatrix}
        0 &amp; 1 \\
        -\omega_0^2 &amp; -2d\omega_0 \\
    \end{bmatrix}
    \cdot z = A \cdot z
\end{equation}

Для такой системы известно аналитическое решение. А еще известно что полная энергия системы должна сохраняться. 

</div>

<h2 id="методы-эйлера">Методы Эйлера</h2>

<h3 id="прямой-метод-эйлера">Прямой метод Эйлера</h3>
<div>
Воспользуемся следующим приближением:
\begin{equation}
    \dot{x} = \frac{dx}{dt} = \lim_{\Delta t\rightarrow 0} \frac{x(t + \Delta t) -x(t)}{\Delta t} \approx \frac{x(t + \Delta t) -x(t)}{\Delta t},
\end{equation}
Если заменить $\approx$ на $=$, пронумеровать положения в узлах и подставить в начальное уравнение, то получится
\begin{equation}
    \begin{split}
        \dot{x_k} = \frac{x_{k+1} -x_k}{\Delta t} = f(x_k),\\
        x_{k+1} = x_k + \dot{x_k}\Delta t = x_k + f(x_k)\Delta t
    \end{split}
\end{equation}
Такие схемы называются явными, т.к. зная $x_k$, можно вычислить $f(x_k)$ и посчитать $x_{k+1}$.

</div>

<h4 id="анализ-точности">Анализ точности</h4>

<div>

Посмотрим на ошибку метода Эйлера. Пусть у нас есть точное решение $x(t)$ и приближенное $x_k$. Тогда
\begin{equation}
    x(t + \Delta t) = x(t) + \dot{x}(t)\Delta t + \frac{\ddot{x}(t)\Delta t^2}{2} + \ldots
\end{equation}
\begin{equation}
    x_{k+1} = x_k + \dot{x_k}\Delta t
\end{equation}
Тогда
\begin{equation}
    x(t + \Delta t) - x_{k+1} = \frac{\ddot{x}(t)\Delta t^2}{2} + \ldots
\end{equation}
Таким образом, локальная ошибка метода Эйлера пропорциональна квадрату шага по времени.
Глобальная ошибка же пропорциональна числу шагов по времени умноженному на локальную ошибку. 
Таким образом, ошибка метода Эйлера пропорциональна шагу по времени.

</div>

<h4 id="анализ-устойчивости">Анализ устойчивости</h4>

<div>

Посмотрим на устойчивость метода Эйлера. Пусть у нас есть уравнение
\begin{equation}
    \dot{y} = \lambda y
\end{equation}
Тогда
\begin{equation}
    y_{k+1} = (1 + \Delta t \cdot \lambda)\cdot y_k
\end{equation}
Для устойчивости решения необходимо
\begin{equation}
    |1 + \Delta t \cdot \lambda| &lt; 1
\end{equation}
Таким образом, зона устойчивости метода Эйлера - круг радиусом 1 с центром в $-1$.

</div>

<h4 id="пример">Пример</h4>

<div>
Попробуем решить уравнение движения пружинки с помощью явного метода Эйлера.
Подставляя на место $\dot{z}$ обсужденное выше приближенное значение, получим следующие равенства для явной$(1)$ схемы:
\begin{equation}
    z_{k+1} = (I + A\cdot\Delta t)\cdot z_k = F\cdot z_k\qquad
\end{equation}
По индукции, получим
\begin{equation}
    z_k = F^k\cdot z_0\qquad
\end{equation}

<span id="forward_euler" class="rounded">
<script src="/physics-in-games/assets/scripts/numerical_method/forward_euler.js"></script>
<button type="button" class="btn btn-primary" data-bs-toggle="button">Toggle button</button>


</span>

Как видно из симуляции энергия системы быстро увеличивается, что говорит о неустойчивости метода Эйлера.

</div>

<h3 id="обратный-метод-эйлера">Обратный метод Эйлера</h3>

<div>
Построим аналогично неявную схему:
\begin{equation}
    \begin{split}
        \dot{x} \approx \frac{x(t) - x(t - \Delta t)}{\Delta t},\\
        \dot{x_k} = \frac{x_k - x_{k-1}}{\Delta t} = f(x_k),\\
        x_{k+1} = x_k + \dot{x_{k+1}}\Delta t = x_k + f(x_{k+1})\Delta t
    \end{split}
\end{equation}
Мы получили неявную схему. 
Такая схема сложнее явной, т.к. в ней нельзя напрямую вычислить следующее положение по предыдущему. Придется или преобразовывать $f(x_{k+1})$, или итеративно подбирать наилучший $x_{k+1}$. 

Зачем тогда вообще пользоваться неявным методом? Дело в том, что прямой метод "вкачивает" в систему энергию, что в конкретных случаях может быть опасно. Обратный метод, в свою очередь, энергию "выкачивает". Он тоже не дает точного приближения, но система с меньшей энергией в среднем более стабильна, за счет чего неявная схема зачастую выигрывает против явной.

</div>

<h4 id="анализ-устойчивости-1">Анализ устойчивости</h4>

<div>
\input{pics/stable_zone_fwd.tex}
Когда обсуждались аналитические решения, было показано, что для устойчивости решения
\begin{equation}
    \dot{y}=A\cdot y
\end{equation}
достаточно условия
\begin{equation}
    Re(eig(A)) &lt; 0.
\end{equation}
Попробуем найти аналогичные условия для явного и неявного методов Эйлера.
Для явного метода, переходя к собственным векторам, получим
\begin{equation}
    y_{k+1} = (1 + \Delta t \cdot \lambda)\cdot y_k
\end{equation}
Для устойчивости решения необходимо
\begin{equation}
    |1 + \Delta t \cdot \lambda| &lt; 1
\end{equation}
Заметим, что меньшие значения $\lambda$ и $\Delta t$ имеют больший шанс попадания в зону стабильности.

\input{pics/stable_zone_bwd.tex}
Для неявного метода, переходя к собственным векторам, получим
\begin{equation}
    y_{k+1} = (1 - \Delta t \cdot \lambda)^{-1}\cdot y_k
\end{equation}
Для устойчивости решения необходимо
\begin{equation}
    |(1 - \Delta t \cdot \lambda)^{-1}| &lt; 1 \Leftrightarrow |1 - \Delta t \cdot \lambda| &gt; 1
\end{equation}
Сразу можно заметить, что зона устойчивости для неявного метода больше, чем у явного; однако при некоторых собственных значений уменьшение временного шага ухудшает стабильность,\\чего для явного метода не наблюдалось.

</div>

<h4 id="пример-1">Пример</h4>

<div>

Подставляя на место $\dot{z}$ обсужденное выше приближенное значение, получим следующие равенствo для неявной$(2)$ схем:
\begin{equation}
    z_{k+1} = (I - A\cdot\Delta t)^{-1}\cdot z_k = B\cdot z_k\qquad (2)
\end{equation}
По индукции, получим
\begin{equation}
    z_k = B^k\cdot z_0\qquad (2)
\end{equation}

<span id="backward_euler" class="rounded" style="max-width: 1152px;">
<script src="/physics-in-games/assets/scripts/numerical_method/backward_euler.js"></script>
</span>

Как видно из симуляции энергия
</div>

<h2 id="методы-рунге-кутты">Методы Рунге-Кутты</h2>

<div>

</div>

<h3 id="метод-рунге-кутты-второго-порядка">Метод Рунге-Кутты второго порядка</h3>

<div>


RK2

</div>

<p>Возможно это нужно в отдельную страницу. 
Методы которые предназначены для решения динамических систем</p>
<h3 id="метод-эйлера-кромера">Метод Эйлера-Кромера</h3>

<div>



</div>

</section>
            </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div></div>
    </div>
</div>

<!-- introduce mathjax support -->
<script>
window.MathJax = {
  tex: {
    inlineMath: [ ['$', '$'], ['\\(', '\\)'] ]
  },
  svg: {
    fontCache: 'global'
  }
};
</script>
<script
  type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
</script>


<!-- introduce per-page mermaid support -->


<!-- introduce mathjax support -->
<script>
    function fixes_chrome_anchors() {
        let chrome = /Chrome/.test(navigator.userAgent) && /Google Inc/.test(navigator.vendor);
        if (window.location.hash && chrome) {
            setTimeout(function () {
                var hash = window.location.hash;
                window.location.hash = "";
                window.location.hash = hash;
            }, 300);
        }
    }

    if (document.readyState === "loading") {
        // Loading hasn't finished yet
        document.addEventListener("DOMContentLoaded", fixes_chrome_anchors);
    } else {
        // `DOMContentLoaded` has already fired
        fixes_chrome_anchors();
    }
</script>


                        <a href="/physics-in-games/" class="navigation navigation-prev navigation-unique" aria-label="Previous page: Physics in Games">
                            <i class="fa fa-angle-left"></i>
                        </a>
                    

                    
                </div>
            </div>

            <script>
            var gitbook = gitbook || [];
            gitbook.push(function() {
                gitbook.page.hasChanged({
    "page": {
        "title": "Introduction",
        "level": "1.1",
        "depth": 1,
        
        "dir": "ltr"
    },    "config": {
        "plugins": ["fontsettings", "highlight", "livereload", "lunr", "search", "sharing", "theme-default", "livereload"],
        "styles": {
            "ebook": "styles/ebook.css",
            "epub": "styles/epub.css",
            "mobi": "styles/mobi.css",
            "pdf": "styles/pdf.css",
            "print": "styles/print.css",
            "website": "styles/website.css"
        },
        "pluginsConfig": {
            "expandable-chapter-small2": {
                "articlesExpand": true,
            },
            "fontsettings": {
                "family": "sans",
                "size": 2,
                "theme": "white"
            },
            "highlight": {},
            "livereload": {},
            "lunr": {
                "ignoreSpecialCharacters": false,
                "maxIndexSize": 1000000
            },
            "search": {},            "sharing": {
                "facebook": true,

                "google": false,

                "github": true,
              
                "github_link": "https://github.com",
              

                "telegram": false,
                "telegram_link": "https://t.me",

                "instapaper": false,

                "twitter": true,
              

                "vk": false,

                "weibo": false,

                "all": ["facebook", "google", "twitter", "weibo", "instapaper", "github", "telegram"]
            },
"theme-default": {
                "showLevel": false,
                "styles": {
                    "ebook": "styles/ebook.css",
                    "epub": "styles/epub.css",
                    "mobi": "styles/mobi.css",
                    "pdf": "styles/pdf.css",
                    "print": "styles/print.css",
                    "website": "styles/website.css"
                }
            },
        },
        "theme": "default",
        "author": "Tao He",
        "pdf": {
            "pageNumbers": true,
            "fontSize": 12,
            "fontFamily": "Arial",
            "paperSize": "a4",
            "chapterMark": "pagebreak",
            "pageBreaksBefore": "/",
            "margin": {
                "right": 62,
                "left": 62,
                "top": 56,
                "bottom": 56
            }
        },
        "structure": {
            "langs": "LANGS.md",
            "readme": "README.md",
        },
        "variables": {},
        "title": "Physics in Games",
        "language": "en",
        "gitbook": "*"
    },
    "file": {
        "path": "_posts/2024-03-28-numerical_method.md",
        "mtime": "2024-03-28 00:00:00 +0300",
        "type": "markdown"
    },
    "gitbook": {
        "version": "3.2.3",
        "time": "2024-04-08 23:43:33 +0300"
    },
    "basePath": "/physics-in-games",
    "book": {
        "language": ""
    }
});
            });
            </script>
        </div><script src="/physics-in-games/assets/gitbook/gitbook.js"></script>
<script src="/physics-in-games/assets/gitbook/theme.js"></script>

<script src="/physics-in-games/assets/gitbook/gitbook-plugin-back-to-top-button/plugin.js"></script>
<script src="/physics-in-games/assets/gitbook/gitbook-plugin-copy-code-button/toggle.js"></script>
<script src="/physics-in-games/assets/gitbook/gitbook-plugin-expandable-chapters-small2/expandable-chapters-small.js"></script>
<script src="/physics-in-games/assets/gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
<script src="/physics-in-games/assets/gitbook/gitbook-plugin-search-pro/jquery.mark.min.js"></script>
<script src="/physics-in-games/assets/gitbook/gitbook-plugin-search-pro/search.js"></script>
<script src="/physics-in-games/assets/gitbook/gitbook-plugin-sharing/buttons.js"></script>
<script src="/physics-in-games/assets/gitbook/gitbook-plugin-splitter/splitter.js"></script>
<script src="/physics-in-games/assets/bootstrap-5.3.3-dist/js/bootstrap.js"></script>

<!--
<script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
<script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
<script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
<script src="../gitbook/gitbook-plugin-search/search.js"></script>
--></body>
</html>