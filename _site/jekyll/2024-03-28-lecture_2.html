<!DOCTYPE HTML>
<html lang="en" >
    <head><meta charset="UTF-8">
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"><title>Численные методы · Physics in Games</title><meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="description" content="Physics in Games is a collection of articles about physics in video games. The articles are written in a simple and understandable language, so that even a person who is not familiar with physics can understand them.
"><meta name="generator" content="Jekyll (using style of GitBook 3.2.3)"><meta name="author" content="Roman Kozak"><link rel="stylesheet" href="/physics-in-games/assets/gitbook/style.css">
<link rel="stylesheet" href="/physics-in-games/assets/gitbook/gitbook-plugin-back-to-top-button/plugin.css">
<link rel="stylesheet" href="/physics-in-games/assets/gitbook/gitbook-plugin-expandable-chapters-small2/expandable-chapters-small.css">
<link rel="stylesheet" href="/physics-in-games/assets/gitbook/gitbook-plugin-fontsettings/website.css">
<link rel="stylesheet" href="/physics-in-games/assets/gitbook/gitbook-plugin-search-pro/search.css">
<link rel="stylesheet" href="/physics-in-games/assets/gitbook/gitbook-plugin-splitter/splitter.css">

<link rel="stylesheet" href="/physics-in-games/assets/gitbook/rouge/colorful.css">

<link rel="stylesheet" href="/physics-in-games/assets/gitbook/custom.css">
<link rel="stylesheet" href="/physics-in-games/assets/gitbook/custom-local.css">

<meta name="HandheldFriendly" content="true"/>
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="/physics-in-games/assets/gitbook/images/apple-touch-icon-precomposed-152.png">
<link rel="shortcut icon" href="/physics-in-games//assets/gitbook/images/favicon.ico" type="image/x-icon">




            <link rel="prev" href="/physics-in-games/jekyll/2023-12-12-footnotes.html" />
        

        
    </head>
    <body>
        <div class="book"><div class="book-summary">
    <script type="text/javascript">
        // Fixes the page links scroll problem on both desktop and mobile browsers
        function pageScrollToTop(element) {
            // both mobile and non-mobile
            $('div.body-inner').animate({scrollTop: 0});
            $(element).parent().find('li>ul>li').removeClass('active');
            return true;  // propagate
        }
        // Fixes the anchor links scroll problem on mobile browsers
        function mobilePageScrollToAnchor(element) {
            $(element).closest('li.chapter').find('ul>li').removeClass('active');
            $(element).parent().addClass('active');
            if ($(document).width() <= 1240) {
                $('div.body-inner').animate({scrollTop: $($(element).attr('href')).get(0).offsetTop});
            }
            return true;
        }
    </script>

    <nav role="navigation">
        <div id="book-search-input" role="search">
            <input type="text" placeholder="Type to search" />
        </div>
        <div id="book-search-input-link" role="search">
            <a href="/physics-in-games/assets/search.html">Click to Search</a>
        </div>
        <ul class="summary">
            
            <li class="chapter" data-level="1.1" data-path="/physics-in-games">
            
                <a href="/physics-in-games/" onclick="pageScrollToTop(this)">
                    Physics in Games
                </a>
            </li>

            <li class="divider"></li>

            
                <!-- <p>pages</p> -->
                
                    

                    
                        
                        <li class="chapter" data-level="1.1" data-path="/physics-in-games/pages/about/">
                        
                            <a href="/physics-in-games/pages/about/" onclick="pageScrollToTop(this)">
                                About
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/physics-in-games/pages/contact/">
                        
                            <a href="/physics-in-games/pages/contact/" onclick="pageScrollToTop(this)">
                                Contact
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/physics-in-games/pages/design/draft/">
                        
                            <a href="/physics-in-games/pages/design/draft/" onclick="pageScrollToTop(this)">
                                Design Draft
                            </a>
                            
                                
                            
                        </li>
                    

                    
                        <li class="divider"></li>
                    
                
            
                <!-- <p>posts</p> -->
                
                    

                    
                        
                        <li class="chapter" data-level="1.1" data-path="/physics-in-games/jekyll/2019-04-28-howto.html">
                        
                            <a href="/physics-in-games/jekyll/2019-04-28-howto.html" onclick="pageScrollToTop(this)">
                                How to Get Started
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/physics-in-games/jekyll/2019-04-29-license.html">
                        
                            <a href="/physics-in-games/jekyll/2019-04-29-license.html" onclick="pageScrollToTop(this)">
                                License
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/physics-in-games/jekyll/2021-08-10-toc.html">
                        
                            <a href="/physics-in-games/jekyll/2021-08-10-toc.html" onclick="pageScrollToTop(this)">
                                How to Generate TOC
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/physics-in-games/jekyll/2022-05-24-page_cover.html">
                        
                            <a href="/physics-in-games/jekyll/2022-05-24-page_cover.html" onclick="pageScrollToTop(this)">
                                Page with cover image
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/physics-in-games/jekyll/2022-06-26-wide_tables.html">
                        
                            <a href="/physics-in-games/jekyll/2022-06-26-wide_tables.html" onclick="pageScrollToTop(this)">
                                Wide tables
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/physics-in-games/jekyll/2022-06-30-tips_warnings_dangers.html">
                        
                            <a href="/physics-in-games/jekyll/2022-06-30-tips_warnings_dangers.html" onclick="pageScrollToTop(this)">
                                Tips, Warnings, and Dangers
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/physics-in-games/jekyll/2023-08-31-mermaid.html">
                        
                            <a href="/physics-in-games/jekyll/2023-08-31-mermaid.html" onclick="pageScrollToTop(this)">
                                Diagrams with mermaid.js
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/physics-in-games/jekyll/2023-10-14-math-latex.html">
                        
                            <a href="/physics-in-games/jekyll/2023-10-14-math-latex.html" onclick="pageScrollToTop(this)">
                                MathJax and LaTeX
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/physics-in-games/jekyll/2023-12-12-footnotes.html">
                        
                            <a href="/physics-in-games/jekyll/2023-12-12-footnotes.html" onclick="pageScrollToTop(this)">
                                Using Footnotes
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter active" data-level="1.2" data-path="/physics-in-games/jekyll/2024-03-28-lecture_2.html">
                        
                            <a href="/physics-in-games/jekyll/2024-03-28-lecture_2.html" onclick="pageScrollToTop(this)">
                                Численные методы
                            </a>
                            
                                
                                    <ul><li><a href="#методы-эйлера" onclick="mobilePageScrollToAnchor(this)" >Методы Эйлера</a></li><li><a href="#зона-устойчивости" onclick="mobilePageScrollToAnchor(this)" >Зона устойчивости</a></li></ul>

                                
                            
                        </li>
                    

                    
                        <li class="divider"></li>
                    
                
            
        </ul>
    </nav>
</div>
<div class="book-body">
                <div class="book-header" role="navigation">
                    <!-- Title -->
                    <h1>
                        <i class="fa fa-circle-o-notch fa-spin"></i>
                        
                            <a href="." >Численные методы</a>
                        
                    </h1>
                </div>

                <div class="body-inner"><div class="page-wrapper" tabindex="-1" role="main">
    

    <div class="page-inner">
        <div id="book-search-results">
            <div class="search-noresults">
                <section class="normal markdown-section">
                    
                        <h1 id="/jekyll/lecture_2">Численные методы</h1>
                    

                    <div>
В прошлой лекции мы попытались решить уравнения движения аналитически. Поскольку некоторые уравнения были не разрешимы, то мы их линеаризовывали. Однако многие эффекты терялись поскольку были нелинейными. 
Поскольку аналитически решить все уравнения невозможно, то мы перейдем к численным методам.

Посмотрим на уравнение в общем виде
\begin{equation}
    \dot{x} = f(x)
\end{equation}
и мы пытались получить из него решение вида
\begin{equation}
    x = F(t) + C
\end{equation}
подставив в которое начальные коодинаты мы могли найти положение в любой момент времени.
Теперь же мы будем искать траекторию, т.е. из начальной координаты $x_0$ численно находим положение в следующий момент времени $x_1$, из него аналогично $x_2$ и т.д. Где раньше мы находили все фазовые траектории, теперь мы будем находить только одну, и ту приближенно.
</div>

<h2 id="методы-эйлера">Методы Эйлера</h2>

<div>
Воспользуемся следующим приближением:
\begin{equation}
    \dot{x} = \frac{dx}{dt} = \lim_{\Delta t\rightarrow 0} \frac{x(t + \Delta t) -x(t)}{\Delta t} \approx \frac{x(t + \Delta t) -x(t)}{\Delta t},
\end{equation}
Пронумеровав положения в узлах и подставив в начальное уравнение, получим
\begin{equation}
    \begin{split}
        \dot{x_k} = \frac{x_{k+1} -x_k}{\Delta t} = f(x_k),\\
        x_{k+1} = x_k + \dot{x_k}\Delta t = x_k + f(x_k)\Delta t
    \end{split}
\end{equation}
Как можно заметить, результатом стала явная схема, т.к. зная $x_k$, можно напрямую вычислить $x_{k+1}$. Построим аналогично неявную схему:
\begin{equation}
    \begin{split}
        \dot{x} \approx \frac{x(t) - x(t - \Delta t)}{\Delta t},\\
        \dot{x_k} = \frac{x_k - x_{k-1}}{\Delta t} = f(x_k),\\
        x_{k+1} = x_k + \dot{x_{k+1}}\Delta t = x_k + f(x_{k+1})\Delta t
    \end{split}
\end{equation}
Понятно, что неявная схема является более сложной, т.к. в ней нельзя напрямую вычислить следующее положение по предыдущему. Придется или преобразовывать $f(x_{k+1})$, или итеративно подбирать наилучший $x_{k+1}$. Зачем тогда вообще пользоваться неявным методом? Дело в том, что прямой метод "вкачивает" в систему энергию, что в конкретных случаях может быть опасно. Обратный метод, в свою очередь, энергию "выкачивает". Он тоже не дает точного приближения, но система с меньшей энергией в среднем более стабильна, за счет чего неявная схема зачастую выигрывает против явной.
\subsubsection{Новая пружинка}
Рассмотрим уже обсужденную задачу с пружинкой, но добавим теперь вязкое трение.

К уже обсужденным закону Гука ($F(x) = -k \cdot x$) и второму закону Ньютона ($\Sigma \vec{F} = m \cdot \vec{a}$) добавится закон вязкого трения:
\begin{equation}
    \vec{F} = -c \cdot \vec{V}
\end{equation}
\input{pics/Scheme.tex}
Введем новые обозначения:
\begin{equation}
    \begin{split}
        d = \frac{c}{2 \sqrt{km}},\\
        \omega_0 = \sqrt{\frac{k}{m}}
    \end{split}
\end{equation}
Подставляя всё это во второй закон Ньютона, получим
\begin{equation}
    \ddot{x} + 2d\omega_0\dot{x} + \omega_0^2 x = 0
\end{equation}
Как и ранее, запишем вектор

\begin{equation}
    z =
     \begin{bmatrix}     1 &amp; x &amp; x^2 \\     1 &amp; y &amp; y^2 \\     1 &amp; z &amp; z^2 \\     \end{bmatrix} 
\end{equation}
Тогда уравнение перепишем в виде
\begin{equation}
    \dot{z} =
    \begin{bmatrix}
        0 &amp; 1 \\
        -\omega_0^2 &amp; -2d\omega_0 \\
    \end{bmatrix}
    \cdot z = A \cdot z
\end{equation}
Подставляя на место $\dot{z}$ обсужденное выше приближенное значение, получим следующие равенства для явной$(1)$ и неявной$(2)$ схем:
\begin{equation}
    \begin{split}
        z_{k+1} = (I + A\cdot\Delta t)\cdot z_k = F\cdot z_k\qquad (1)\\
        z_{k+1} = (I - A\cdot\Delta t)^{-1}\cdot z_k = B\cdot z_k\qquad (2)
    \end{split}
\end{equation}
По индукции, получим
\begin{equation}
    \begin{split}
        z_k = F^k\cdot z_0\qquad (1)\\
        z_k = B^k\cdot z_0\qquad (2)
    \end{split}
\end{equation}
</div>

<h2 id="зона-устойчивости">Зона устойчивости</h2>

<div>
\input{pics/stable_zone_fwd.tex}
Когда обсуждались аналитические решения, было показано, что для устойчивости решения
\begin{equation}
    \dot{y}=A\cdot y
\end{equation}
достаточно условия
\begin{equation}
    Re(eig(A)) &lt; 0.
\end{equation}
Попробуем найти аналогичные условия для явного и неявного методов Эйлера.
Для явного метода, переходя к собственным векторам, получим
\begin{equation}
    y_{k+1} = (1 + \Delta t \cdot \lambda)\cdot y_k
\end{equation}
Для устойчивости решения необходимо
\begin{equation}
    |1 + \Delta t \cdot \lambda| &lt; 1
\end{equation}
Заметим, что меньшие значения $\lambda$ и $\Delta t$ имеют больший шанс попадания в зону стабильности.

\input{pics/stable_zone_bwd.tex}
Для неявного метода, переходя к собственным векторам, получим
\begin{equation}
    y_{k+1} = (1 - \Delta t \cdot \lambda)^{-1}\cdot y_k
\end{equation}
Для устойчивости решения необходимо
\begin{equation}
    |(1 - \Delta t \cdot \lambda)^{-1}| &lt; 1 \Leftrightarrow |1 - \Delta t \cdot \lambda| &gt; 1
\end{equation}
Сразу можно заметить, что зона устойчивости для неявного метода больше, чем у явного; однако при некоторых собственных значений уменьшение временного шага ухудшает стабильность,\\чего для явного метода не наблюдалось.

</div>

</section>
            </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div></div>
    </div>
</div>

<!-- introduce mathjax support -->
<script>
window.MathJax = {
  tex: {
    inlineMath: [ ['$', '$'], ['\\(', '\\)'] ]
  },
  svg: {
    fontCache: 'global'
  }
};
</script>
<script
  type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
</script>


<!-- introduce per-page mermaid support -->


<!-- introduce mathjax support -->
<script>
    function fixes_chrome_anchors() {
        let chrome = /Chrome/.test(navigator.userAgent) && /Google Inc/.test(navigator.vendor);
        if (window.location.hash && chrome) {
            setTimeout(function () {
                var hash = window.location.hash;
                window.location.hash = "";
                window.location.hash = hash;
            }, 300);
        }
    }

    if (document.readyState === "loading") {
        // Loading hasn't finished yet
        document.addEventListener("DOMContentLoaded", fixes_chrome_anchors);
    } else {
        // `DOMContentLoaded` has already fired
        fixes_chrome_anchors();
    }
</script>


                        <a href="/physics-in-games/jekyll/2023-12-12-footnotes.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page: Using Footnotes">
                            <i class="fa fa-angle-left"></i>
                        </a>
                    

                    
                </div>
            </div>

            <script>
            var gitbook = gitbook || [];
            gitbook.push(function() {
                gitbook.page.hasChanged({
    "page": {
        "title": "Introduction",
        "level": "1.1",
        "depth": 1,
        
        "dir": "ltr"
    },    "config": {
        "plugins": ["fontsettings", "highlight", "livereload", "lunr", "search", "sharing", "theme-default", "livereload"],
        "styles": {
            "ebook": "styles/ebook.css",
            "epub": "styles/epub.css",
            "mobi": "styles/mobi.css",
            "pdf": "styles/pdf.css",
            "print": "styles/print.css",
            "website": "styles/website.css"
        },
        "pluginsConfig": {
            "expandable-chapter-small2": {
                "articlesExpand": true,
            },
            "fontsettings": {
                "family": "sans",
                "size": 2,
                "theme": "white"
            },
            "highlight": {},
            "livereload": {},
            "lunr": {
                "ignoreSpecialCharacters": false,
                "maxIndexSize": 1000000
            },
            "search": {},            "sharing": {
                "facebook": true,

                "google": false,

                "github": true,
              
                "github_link": "https://github.com",
              

                "telegram": false,
                "telegram_link": "https://t.me",

                "instapaper": false,

                "twitter": true,
              

                "vk": false,

                "weibo": false,

                "all": ["facebook", "google", "twitter", "weibo", "instapaper", "github", "telegram"]
            },
"theme-default": {
                "showLevel": false,
                "styles": {
                    "ebook": "styles/ebook.css",
                    "epub": "styles/epub.css",
                    "mobi": "styles/mobi.css",
                    "pdf": "styles/pdf.css",
                    "print": "styles/print.css",
                    "website": "styles/website.css"
                }
            },
        },
        "theme": "default",
        "author": "Tao He",
        "pdf": {
            "pageNumbers": true,
            "fontSize": 12,
            "fontFamily": "Arial",
            "paperSize": "a4",
            "chapterMark": "pagebreak",
            "pageBreaksBefore": "/",
            "margin": {
                "right": 62,
                "left": 62,
                "top": 56,
                "bottom": 56
            }
        },
        "structure": {
            "langs": "LANGS.md",
            "readme": "README.md",
        },
        "variables": {},
        "title": "Physics in Games",
        "language": "en",
        "gitbook": "*"
    },
    "file": {
        "path": "_posts/2024-03-28-lecture_2.md",
        "mtime": "2024-03-28 00:00:00 +0300",
        "type": "markdown"
    },
    "gitbook": {
        "version": "3.2.3",
        "time": "2024-03-29 19:02:42 +0300"
    },
    "basePath": "/physics-in-games",
    "book": {
        "language": ""
    }
});
            });
            </script>
        </div><script src="/physics-in-games/assets/gitbook/gitbook.js"></script>
<script src="/physics-in-games/assets/gitbook/theme.js"></script>

<script src="/physics-in-games/assets/gitbook/gitbook-plugin-back-to-top-button/plugin.js"></script>
<script src="/physics-in-games/assets/gitbook/gitbook-plugin-copy-code-button/toggle.js"></script>
<script src="/physics-in-games/assets/gitbook/gitbook-plugin-expandable-chapters-small2/expandable-chapters-small.js"></script>
<script src="/physics-in-games/assets/gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
<script src="/physics-in-games/assets/gitbook/gitbook-plugin-search-pro/jquery.mark.min.js"></script>
<script src="/physics-in-games/assets/gitbook/gitbook-plugin-search-pro/search.js"></script>
<script src="/physics-in-games/assets/gitbook/gitbook-plugin-sharing/buttons.js"></script>
<script src="/physics-in-games/assets/gitbook/gitbook-plugin-splitter/splitter.js"></script>

<!--
<script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
<script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
<script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
<script src="../gitbook/gitbook-plugin-search/search.js"></script>
-->

</body>
</html>